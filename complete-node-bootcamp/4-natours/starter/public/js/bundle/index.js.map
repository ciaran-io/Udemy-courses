{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/login.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["/* eslint-disable */\nexport const displayMap = (locations) => {\n  mapboxgl.accessToken =\n    'pk.eyJ1IjoiY2lhcmFuLWlvIiwiYSI6ImNsM3JldjMwaTFlOWMzY2xuN3c4OWR5MncifQ.HewTA51E7BnHp2jFz5kdLg';\n\n  var map = new mapboxgl.Map({\n    container: 'map',\n    style: 'mapbox://styles/ciaran-io/cl3sp3hno000a14pd31f3zhc0',\n    scrollZoom: false,\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach((location) => {\n    // Create marker\n    const divEl = document.createElement('div');\n    divEl.className = 'marker';\n\n    // Add marker\n    new mapboxgl.Marker({\n      element: divEl,\n      anchor: 'bottom',\n    })\n      .setLngLat(location.coordinates)\n      .addTo(map);\n\n    // Add popup\n    new mapboxgl.Popup({\n      offset: 30,\n    })\n      .setLngLat(location.coordinates)\n      .setHTML(`<P>Day ${location.day}: ${location.description}</p>`)\n      .addTo(map);\n\n    // Extends map bounds to include  current location\n    bounds.extend(location.coordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      bottom: 150,\n      left: 100,\n      right: 100,\n    },\n  });\n\n};\n","\nexport const hideAlert = () => {\n  const element = document.querySelector('.alert');\n  if (element) element.parentElement.removeChild(element)\n}\nexport const showAlert = (type, msg) => {\n  hideAlert();\n\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup)\n\n  window.setTimeout(hideAlert, 5000)\n};\n\n","/* eslint-disable */\n//Not working with Parcel js import axios from 'axios';\nimport { showAlert } from './alerts';\nexport const login = async (email, password) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/users/login',\n      data: {\n        email,\n        password,\n      },\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('Success', 'logged in successfully');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('Error', err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/users/logout',\n    });\n\n    if ((res.data.status = 'success')) location.reload(true);\n  } catch (err) {\n    showAlert('error', 'Error logging out! Try again');\n  }\n};\n","/* eslint-disable */\nimport { showAlert } from './alerts';\n\n// update data of user\n// type is either 'password or ' data\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/users/updateMyPassword'\n        : '/api/v1/users/updateMe';\n\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data,\n    });\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully`);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n","/* eslint-disable */\nimport { showAlert } from './alerts';\n\nexport const bookTour = async (tourId) => {\n  const stripe = Stripe(\n    'pk_test_51LAX43Bi1W41eI4puEBLEHHnMaWt27in59NAjckHgvtey3NB0ZueIDNfS8z5Iq2lhsPZnuCCbKU6hmvoMCQZxKgH00KxmbYBAc'\n  );\n  try {\n    // 1. Get checkout session fro, API\n    const session = await axios(\n      `/api/v1/booking/checkout-session/${tourId}`\n    );\n    // 2. Create checkout form + charge credit card\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (err) {\n    console.log(err);\n    showAlert('error', err);\n  }\n};\n","/* eslint-disable */\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe'\n// DOM Elements\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('form.form-login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userDataPassword = document.querySelector('.form-user-password');\nconst bookBtn = document.querySelector('#book-tour')\n\n// Delegation\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener('submit', (event) => {\n    event.preventDefault();\n    // Values\n    const emailInputVal = document.querySelector('input#email').value;\n    const passwordInputVal = document.querySelector('input#password').value;\n    login(emailInputVal, passwordInputVal);\n  });\n}\n\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\nif (userDataForm) {\n  userDataForm.addEventListener('submit', (event) => {\n    event.preventDefault();\n    const form = new FormData();\n    form.append('name', document.querySelector('input[name=\"name\"]').value);\n    form.append('email', document.querySelector('input[name=\"email\"]').value);\n    form.append(\n      'photo',\n      document.querySelector('input[name=\"photo\"]').files[0]\n    );\n    updateSettings(form, 'data');\n  });\n}\n\nif (userDataPassword) {\n  userDataPassword.addEventListener('submit', async (event) => {\n    event.preventDefault();\n\n    const savePasswordBtn = userDataPassword.querySelector('button');\n\n    savePasswordBtn.textContent = 'Updating...';\n\n    const passwordCurrent = document.querySelector(\n      'input#password-current'\n    ).value;\n    const password = document.querySelector('input#password').value;\n    const passwordConfirm = document.querySelector(\n      'input#password-confirm'\n    ).value;\n\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      'password'\n    );\n\n    savePasswordBtn.textContent = 'save password';\n    const passwordInputs = userDataPassword.querySelectorAll(\n      'input[type=\"password\"]'\n    );\n    // reset current password input\n    passwordInputs.forEach((el) => (el.value = ''));\n  });\n}\n\nif (bookBtn) {\n  bookBtn.addEventListener('click', event => {\n    event.target.textContent = 'Processing'\n    const { tourId } = event.target.dataset;\n    bookTour(tourId)\n  })\n}\n"],"names":["$4f43d81bcce2c3fd$export$4c5dd147b21b9176","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","location","divEl","document","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$ebac7bf48313c3ff$export$516836c6a9dfc573","querySelector","parentElement","removeChild","$ebac7bf48313c3ff$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$90e3456be1d5a06a$export$596d806903d1f59e","async","email","password","axios","method","url","data","status","assign","err","response","message","$a9bfe9e05428b54c$export$f558026a994b6051","toUpperCase","$ba4dd76cfd0ffcab$export$8d5bdbf26681c0c2","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","console","log","$dbbcb7a1c7d65a2c$var$mapBox","getElementById","$dbbcb7a1c7d65a2c$var$loginForm","$dbbcb7a1c7d65a2c$var$logOutBtn","$dbbcb7a1c7d65a2c$var$userDataForm","$dbbcb7a1c7d65a2c$var$userDataPassword","$dbbcb7a1c7d65a2c$var$bookBtn","JSON","parse","dataset","addEventListener","event","preventDefault","emailInputVal","value","passwordInputVal","reload","form","FormData","append","files","savePasswordBtn","textContent","passwordCurrent","passwordConfirm","querySelectorAll","el","target"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}