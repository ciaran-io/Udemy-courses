const e=e=>{mapboxgl.accessToken="pk.eyJ1IjoiY2lhcmFuLWlvIiwiYSI6ImNsM3JldjMwaTFlOWMzY2xuN3c4OWR5MncifQ.HewTA51E7BnHp2jFz5kdLg";var t=new mapboxgl.Map({container:"map",style:"mapbox://styles/ciaran-io/cl3sp3hno000a14pd31f3zhc0",scrollZoom:!1});const o=new mapboxgl.LngLatBounds;e.forEach((e=>{const a=document.createElement("div");a.className="marker",new mapboxgl.Marker({element:a,anchor:"bottom"}).setLngLat(e.coordinates).addTo(t),new mapboxgl.Popup({offset:30}).setLngLat(e.coordinates).setHTML(`<P>Day ${e.day}: ${e.description}</p>`).addTo(t),o.extend(e.coordinates)})),t.fitBounds(o,{padding:{top:200,bottom:150,left:100,right:100}})},t=()=>{const e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},o=(e,o)=>{t();const a=`<div class="alert alert--${e}">${o}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",a),window.setTimeout(t,5e3)},a=async(e,t)=>{try{"success"===(await axios({method:"POST",url:"/api/v1/users/login",data:{email:e,password:t}})).data.status&&(o("Success","logged in successfully"),window.setTimeout((()=>{location.assign("/")}),1500))}catch(e){o("Error",e.response.data.message)}},s=async(e,t)=>{try{const a="password"===t?"/api/v1/users/updateMyPassword":"/api/v1/users/updateMe";"success"===(await axios({method:"PATCH",url:a,data:e})).data.status&&o("success",`${t.toUpperCase()} updated successfully`)}catch(e){o("error",e.response.data.message)}},r=async e=>{const t=Stripe("pk_test_51LAX43Bi1W41eI4puEBLEHHnMaWt27in59NAjckHgvtey3NB0ZueIDNfS8z5Iq2lhsPZnuCCbKU6hmvoMCQZxKgH00KxmbYBAc");try{const o=await axios(`/api/v1/booking/checkout-session/${e}`);await t.redirectToCheckout({sessionId:o.data.session.id})}catch(e){console.log(e),o("error",e)}},n=document.getElementById("map"),c=document.querySelector("form.form-login"),u=document.querySelector(".nav__el--logout"),d=document.querySelector(".form-user-data"),i=document.querySelector(".form-user-password"),l=document.querySelector("#book-tour");if(n){e(JSON.parse(n.dataset.locations))}c&&c.addEventListener("submit",(e=>{e.preventDefault();const t=document.querySelector("input#email").value,o=document.querySelector("input#password").value;a(t,o)})),u&&u.addEventListener("click",(async()=>{try{(await axios({method:"GET",url:"/api/v1/users/logout"})).data.status="success",location.reload(!0)}catch(e){o("error","Error logging out! Try again")}})),d&&d.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData;t.append("name",document.querySelector('input[name="name"]').value),t.append("email",document.querySelector('input[name="email"]').value),t.append("photo",document.querySelector('input[name="photo"]').files[0]),s(t,"data")})),i&&i.addEventListener("submit",(async e=>{e.preventDefault();const t=i.querySelector("button");t.textContent="Updating...";const o=document.querySelector("input#password-current").value,a=document.querySelector("input#password").value,r=document.querySelector("input#password-confirm").value;await s({passwordCurrent:o,password:a,passwordConfirm:r},"password"),t.textContent="save password";i.querySelectorAll('input[type="password"]').forEach((e=>e.value=""))})),l&&l.addEventListener("click",(e=>{e.target.textContent="Processing";const{tourId:t}=e.target.dataset;r(t)}));
//# sourceMappingURL=index.js.map
